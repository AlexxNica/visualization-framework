{
    "id":"vss-domain-flow-table",
    "title":"Flow Information",
    "service":"elasticsearch",
    "query":{
        "index":"{{index:nuage_flow}}",
        "type":"{{type:nuage_doc_type}}",
        "body":{
          sort: [
            { "timestamp": { "order": "desc" } }
          ],
          query: {
            bool: {
              should: [
        	    {
           	    "bool": {
             	    "must": [
                    {"term": {"nuage_metadata.sourcepolicygroups": "{{spg:default}}}" },
                    { "term": {"nuage_metadata.destinationpolicygroups": "{{dpg:default}}"} },
                    {"range": { "timestamp": { "gte": "{{startTime: now-24h}}", "lte": "{{endTime: now}}", "format":"epoch_millis"} }}
                  ]
                }
              },
              {
                "bool": {
                  "must": [
                    { "term": {"nuage_metadata.sourcepolicygroups": "{{dpg:default}}"} },
                    { "term": {"nuage_metadata.destinationpolicygroups": "{{spg:default}}"} },
                    {"range": { "timestamp": {"gte": "{{startTime: now-24h}}", "lte": "{{endTime: now}}", "format":"epoch_millis"} }}
                  ] 
                }
              }
              ]
            }
          }
        }
    }
}
